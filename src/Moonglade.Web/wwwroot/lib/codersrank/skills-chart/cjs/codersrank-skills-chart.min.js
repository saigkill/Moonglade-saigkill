/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@codersrank/skills-chart@0.9.21/cjs/codersrank-skills-chart.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var _fetchData=require("./shared/fetch-data"),_renderChart=require("./shared/render-chart"),_renderError=require("./shared/render-error"),_renderLoading=require("./shared/render-loading"),_getChartData=require("./shared/get-chart-data"),_formatScore=require("./shared/format-score");function _defineProperties(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _inheritsLoose(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,t)},_wrapNativeSuper(t)}function _construct(t,e,r){return _construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,r){var i=[null];i.push.apply(i,e);var s=new(Function.bind.apply(t,i));return r&&_setPrototypeOf(s,r.prototype),s},_construct.apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}var COMPONENT_TAG="codersrank-skills-chart",STATE_IDLE=0,STATE_LOADING=1,STATE_ERROR=2,STATE_SUCCESS=3,STYLES=":host{--font-family:Open Sans,Helvetica Neue,Helvetica,Arial,sans-serif;--svg-width:100%;--svg-height:auto;--axis-bg-color:rgba(0, 0, 0, 0.35);--hidden-area-color:#ddd;--label-text-color:inherit;--label-font-size:10px;--label-font-weight:500;--label-white-space:nowrap;--legend-text-color:inherit;--legend-disabled-text-color:#ccc;--legend-font-size:14px;--preloader-color:#72a0a8;--tooltip-font-size:12px;--tooltip-total-font-size:16px;--tooltip-total-font-weight:bold;--other-skills-area-color:#bbb;--chart-bg-color:transparent;--chart-border-radius:0px;--branding-text-color:inherit;width:100%;display:block;position:relative;box-sizing:border-box}.codersrank-skills-chart{font-family:var(--font-family);position:relative}.codersrank-skills-chart-preloader{position:absolute;left:50%;top:50%;width:32px;height:32px;margin:-16px 0 0 -16px;border:3px solid var(--preloader-color);border-left-color:transparent;border-bottom-color:transparent;border-radius:50%;box-sizing:border-box;-webkit-animation:preloader 1s infinite linear;animation:preloader 1s infinite linear}.codersrank-skills-chart-svg{position:relative}.codersrank-skills-chart svg{width:var(--svg-width);height:var(--svg-height);display:block;background-color:var(--chart-bg-color);border-radius:var(--chart-border-radius)}.codersrank-skills-chart polygon{transition-duration:150ms}.codersrank-skills-chart-current-line{stroke:rgba(0,0,0,.25);stroke-width:1px}.codersrank-skills-chart-hidden{fill:var(--hidden-area-color)!important}.codersrank-skills-chart-axis{margin-bottom:36px;height:1px;background:var(--axis-bg-color);color:inherit;display:flex;font-size:var(--label-font-size);font-weight:var(--label-font-weight);justify-content:space-between;line-height:1;color:var(--label-text-color)}.codersrank-skills-chart-axis>span{padding-top:10px;width:0;display:flex;align-items:flex-start;justify-content:center;white-space:var(--label-white-space)}.codersrank-skills-chart-axis>span:first-child{justify-content:flex-start}.codersrank-skills-chart-axis>span:last-child{justify-content:flex-end}.codersrank-skills-chart-tooltip{pointer-events:none;text-align:left;line-height:1.4;position:absolute;background:#000;border-radius:4px;color:#fff;font-family:var(--font-family);padding:8px;font-size:var(--tooltip-font-size);white-space:nowrap;pointer-events:none;top:50%;transform:translateX(-100%) translateY(-50%);margin-left:-10px;z-index:10}.codersrank-skills-chart-tooltip-right{margin-left:10px;transform:translateY(-50%)}.codersrank-skills-chart-tooltip-label{color:rgba(255,255,255,.75)}.codersrank-skills-chart-tooltip-total{font-size:var(--tooltip-total-font-size);font-weight:var(--tooltip-total-font-weight)}.codersrank-skills-chart-tooltip-list{list-style:none;margin:0;padding:0}.codersrank-skills-chart-tooltip-list span{display:inline-block;width:10px;height:10px;border-radius:50%;margin-right:4px}.codersrank-skills-chart-legend{display:flex;flex-wrap:wrap;align-items:center;justify-content:center;font-size:var(--legend-font-size);width:100%;color:var(--legend-text-color);margin-top:36px}.codersrank-skills-chart-legend-button{color:inherit;width:auto;-webkit-appearance:none!important;-moz-appearance:none!important;appearance:none!important;background-color:transparent;border-radius:0;border:none;outline:0!important;cursor:pointer;font-family:inherit;font-size:inherit;box-shadow:none!important;display:flex;align-items:center;font-weight:500;transition-duration:.2s;padding:4px 8px}.codersrank-skills-chart-legend-button span{transition-duration:.2s;width:14px;height:14px;margin-right:4px;border-radius:50%}.codersrank-skills-chart-legend-button-hidden{color:var(--legend-disabled-text-color)}.codersrank-skills-chart-legend-button-hidden span{background-color:var(--legend-disabled-text-color)!important}.codersrank-skills-chart-branding{font-size:12px;color:var(--branding-text-color);position:absolute;left:0;top:0}.codersrank-skills-chart-branding a{opacity:.5;display:flex;align-items:center;color:inherit;text-decoration:none;transition-duration:.2s;position:relative;z-index:1;transform:translate3d(0,0,0)}.codersrank-skills-chart-branding a:hover{opacity:1}.codersrank-skills-chart-branding span{margin-right:4px}.codersrank-skills-chart-branding svg{height:16px;width:auto}@-webkit-keyframes preloader{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}@keyframes preloader{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}",CodersRankSkillsChart=function(t){function e(){var e;return(e=t.call(this)||this).tempDiv=document.createElement("div"),e.shadowEl=e.attachShadow({mode:"closed"}),e.stylesEl=document.createElement("style"),e.stylesEl.textContent=STYLES,e.shadowEl.appendChild(e.stylesEl),e.onMouseEnter=e.onMouseEnter.bind(_assertThisInitialized(e)),e.onMouseLeave=e.onMouseLeave.bind(_assertThisInitialized(e)),e.onClick=e.onClick.bind(_assertThisInitialized(e)),e.formatLabel=e.formatLabel.bind(_assertThisInitialized(e)),e.onSVGMouseEnter=e.onSVGMouseEnter.bind(_assertThisInitialized(e)),e.onSVGMouseMove=e.onSVGMouseMove.bind(_assertThisInitialized(e)),e.onSVGMouseLeave=e.onSVGMouseLeave.bind(_assertThisInitialized(e)),e.linesOffsets=[],e.currentIndex=null,e.activeSkillsSet=!1,e.hiddenDatasets=[],e.highlightedDatasetLabel=null,e.highlightedDatasetTimeout=null,e.mounted=!1,e.state=STATE_IDLE,e.data={labels:[],datasets:[]},e}_inheritsLoose(e,t);var r=e.prototype;return r.getHighestScore=function(t){var e=0,r=null;return t.forEach((function(t){var i=0;t.languages.forEach((function(t){i+=t.score})),i>e&&(e=i,r=t.date)})),{score:e,date:r}},r.emitData=function(t){void 0===t&&(t={});var e=t.scores||{},r=new CustomEvent("data",{detail:{scores:e,highest:this.getHighestScore(e)}});this.dispatchEvent(r)},r.emitError=function(t){var e=new CustomEvent("error",{detail:t});this.dispatchEvent(e)},r.emitRender=function(){var t=new CustomEvent("render");this.dispatchEvent(t)},r.formatLabel=function(t){return t?Intl.DateTimeFormat("en",{year:"numeric",month:"short"}).format(new Date(t)):""},r.render=function(){var t=this.username,e=this.id,r=this.mounted,i=this.state,s=this.shadowEl,n=this.data,o=this.svgWidth,a=this.svgHeight,l=this.legend,c=this.labels,h=this.branding,d=this.sortByScore,u=this.hiddenDatasets,f=this.highlightedDatasetLabel,g=this.visibleLabels,p=this.currentIndex,v=this.formatLabel,b=this.tempDiv,k={data:n,svgWidth:o,svgHeight:a,legend:l,labels:c,branding:h,sortByScore:d,hiddenDatasets:u,highlightedDatasetLabel:f,visibleLabels:g,currentIndex:p,formatLabel:v};if(this.detachSVGEvents(),(t||e)&&r){i===STATE_SUCCESS?b.innerHTML=(0,_renderChart.renderChart)(k):i===STATE_ERROR?b.innerHTML=(0,_renderError.renderError)(k):i!==STATE_IDLE&&i!==STATE_LOADING||(b.innerHTML=(0,_renderLoading.renderLoading)(k));var m=s.querySelector(".codersrank-skills-chart");m&&m.parentNode.removeChild(m),(m=b.querySelector(".codersrank-skills-chart"))&&(this.widgetEl=m,s.appendChild(m),this.attachSVGEvents(),i===STATE_SUCCESS&&this.emitRender())}},r.loadAndRender=function(){var t=this,e=this.username,r=this.id;this.state=STATE_LOADING,this.render(),(0,_fetchData.fetchData)(e,r).then((function(e){t.emitData(e),t.data=(0,_getChartData.getChartData)(e.scores,t.displaySkills,t.showOtherSkills,t.sortByScore),t.activeSkills&&t.activeSkills.length&&!t.activeSkillsSet&&(t.hiddenDatasets=t.data.datasets.map((function(t){return t.label})).filter((function(e){return t.activeSkills.indexOf(e)<0})),t.activeSkillsSet=!0),t.state=STATE_SUCCESS,t.render()})).catch((function(e){t.emitError(e),t.state=STATE_ERROR,t.render()}))},r.tooltipText=function(){var t=this,e=this.currentIndex,r=this.data,i=r.datasets,s=r.labels;if(null===e)return"";var n=0,o=i.filter((function(r){return!t.hiddenDatasets.includes(r.label)&&r.values[e]})).map((function(t){return{color:t.color,label:t.label,value:t.values[e]}}));return o.forEach((function(t){n+=t.value})),'\n        <div class="codersrank-skills-chart-tooltip-label">'+this.formatLabel(s[e])+'</div>\n        <div class="codersrank-skills-chart-tooltip-total">'+((0,_formatScore.formatScore)(n)+" exp. points")+"</div>\n        "+(o.length>0?'\n      <ul class="codersrank-skills-chart-tooltip-list">\n        '+o.map((function(t){var e=t.label,r=t.color,i=t.value;return'\n              <li><span style="background-color: '+r+';"></span>'+(e+": "+(0,_formatScore.formatScore)(i))+"</li>\n            "})).join("")+"\n      </ul>":"")+"\n      "},r.showTooltip=function(){var t=this;if(this.tooltip)if(this.data.datasets.filter((function(e){return!t.hiddenDatasets.includes(e.label)})).length){var e=this.shadowEl.querySelector(".codersrank-skills-chart-current-line");e&&e.classList.remove("codersrank-skills-chart-current-line");var r=this.shadowEl.querySelector('line[data-index="'+this.currentIndex+'"]');if(r){r.classList.add("codersrank-skills-chart-current-line");var i=this.widgetEl.querySelector(".codersrank-skills-chart-tooltip");i?i.innerHTML=this.tooltipText():(this.tempDiv.innerHTML='\n        <div class="codersrank-skills-chart-tooltip">\n          '+this.tooltipText()+"\n        </div>\n      ",i=this.tempDiv.querySelector(".codersrank-skills-chart-tooltip"),this.widgetEl.querySelector(".codersrank-skills-chart-svg").appendChild(i));var s=this.widgetEl.getBoundingClientRect(),n=r.getBoundingClientRect().left-s.left;n<180?i.classList.add("codersrank-skills-chart-tooltip-right"):i.classList.remove("codersrank-skills-chart-tooltip-right"),i.style.left=n+"px"}}else this.hideTooltip()},r.hideTooltip=function(){if(this.tooltip){var t=this.shadowEl.querySelector(".codersrank-skills-chart-current-line");t&&t.classList.remove("codersrank-skills-chart-current-line");var e=this.shadowEl.querySelector(".codersrank-skills-chart-tooltip");e&&this.widgetEl.querySelector(".codersrank-skills-chart-svg").removeChild(e)}},r.toggleDataset=function(t){this.highlightedDatasetLabel=null,this.hiddenDatasets.includes(t)?this.hiddenDatasets.splice(this.hiddenDatasets.indexOf(t),1):(this.hiddenDatasets.push(t),this.highlightedDatasetLabel=null),this.render()},r.onClick=function(t){var e;if("BUTTON"===t.target.tagName?e=t.target:t.target.parentNode&&"BUTTON"===t.target.parentNode.tagName&&(e=t.target.parentNode),e){var r=e.getAttribute("data-label");this.toggleDataset(r)}},r.onMouseEnter=function(t){var e,r=this;if(this.widgetEl&&("BUTTON"===t.target.tagName&&(e=t.target),e)){var i=e.getAttribute("data-label");if(i){var s=this.widgetEl.querySelector('polygon[data-label="'+i+'"]');s&&(clearTimeout(this.highlightedDatasetTimeout),this.highlightedDatasetTimeout=setTimeout((function(){r.highlightedDatasetLabel=i;for(var t=r.widgetEl.querySelectorAll("polygon"),e=0;e<t.length;e+=1)t[e].classList.add("codersrank-skills-chart-hidden");s.classList.remove("codersrank-skills-chart-hidden")}),100))}}},r.onMouseLeave=function(t){var e=this;"BUTTON"===t.target.tagName&&(this.highlightedDatasetTimeout=setTimeout((function(){if(e.widgetEl){var t=e.widgetEl.querySelectorAll("polygon");if(t)for(var r=0;r<t.length;r+=1)t[r].classList.remove("codersrank-skills-chart-hidden")}}),100))},r.calcLinesOffsets=function(){var t=this.widgetEl.querySelectorAll("line");this.linesOffsets=[];for(var e=0;e<t.length;e+=1)this.linesOffsets.push(t[e].getBoundingClientRect().left)},r.onSVGMouseEnter=function(){this.tooltip&&this.calcLinesOffsets()},r.onSVGMouseMove=function(t){if(this.tooltip){var e=t.pageX;void 0===e&&(e=0);var r=this.linesOffsets.map((function(t){return Math.abs(e-t)})),i=Math.min.apply(Math,r),s=r.indexOf(i);this.currentIndex=s,this.showTooltip()}},r.onSVGMouseLeave=function(){this.tooltip&&(this.currentIndex=null,this.hideTooltip())},r.attachSVGEvents=function(){if(this.widgetEl){var t=this.widgetEl.querySelector("svg");t&&(t.addEventListener("mouseenter",this.onSVGMouseEnter),t.addEventListener("mousemove",this.onSVGMouseMove),t.addEventListener("mouseleave",this.onSVGMouseLeave))}},r.detachSVGEvents=function(){if(this.widgetEl){var t=this.widgetEl.querySelector("svg");t&&(t.removeEventListener("mouseenter",this.onSVGMouseEnter),t.removeEventListener("mousemove",this.onSVGMouseMove),t.removeEventListener("mouseleave",this.onSVGMouseLeave))}},r.attributeChangedCallback=function(){this.mounted&&this.loadAndRender()},r.connectedCallback=function(){this.width=this.offsetWidth,this.mounted=!0,this.loadAndRender(),this.shadowEl.addEventListener("click",this.onClick,!0),this.shadowEl.addEventListener("mouseenter",this.onMouseEnter,!0),this.shadowEl.addEventListener("mouseleave",this.onMouseLeave,!0)},r.disconnectedCallback=function(){this.mounted=!1,this.shadowEl.removeEventListener("click",this.onClick),this.shadowEl.removeEventListener("mouseenter",this.onMouseEnter),this.shadowEl.removeEventListener("mouseleave",this.onMouseLeave),this.detachSVGEvents()},_createClass(e,[{key:"visibleLabels",get:function(){if(!this.maxLabels||this.data.labels.length<=this.maxLabels)return this.data.labels;var t=Math.ceil(this.data.labels.length/this.maxLabels);return this.data.labels.filter((function(e,r){return r%t==0}))}},{key:"displaySkills",get:function(){var t=this.getAttribute("skills")||"";return"string"!=typeof t?[]:t.split(",").map((function(t){return t.trim()})).filter((function(t){return!!t}))}},{key:"skills",set:function(t){this.setAttribute("skills",t)}},{key:"activeSkills",get:function(){var t=this.getAttribute("active-skills")||"";return"string"!=typeof t?[]:t.split(",").map((function(t){return t.trim()})).filter((function(t){return!!t}))},set:function(t){this.setAttribute("active-skills",t)}},{key:"active-skills",set:function(t){this.setAttribute("active-skills",t)}},{key:"showOtherSkills",get:function(){var t=this.getAttribute("show-other-skills");return""===t||"true"===t},set:function(t){this.setAttribute("show-other-skills",t)}},{key:"show-other-skills",set:function(t){this.setAttribute("show-other-skills",t)}},{key:"tooltip",get:function(){var t=this.getAttribute("tooltip");return""===t||"true"===t},set:function(t){this.setAttribute("tooltip",t)}},{key:"username",get:function(){return this.getAttribute("username")},set:function(t){this.setAttribute("username",t)}},{key:"id",get:function(){return this.getAttribute("id")},set:function(t){this.setAttribute("id",t)}},{key:"maxLabels",get:function(){return parseInt(this.getAttribute("max-labels")||0,10)||8},set:function(t){this.setAttribute("max-labels",t)}},{key:"max-labels",set:function(t){this.setAttribute("max-labels",t)}},{key:"svgWidth",get:function(){return parseInt(this.getAttribute("svg-width")||0,10)||640},set:function(t){this.setAttribute("svg-width",t)}},{key:"svg-width",set:function(t){this.setAttribute("svg-width",t)}},{key:"svgHeight",get:function(){return parseInt(this.getAttribute("svg-height")||0,10)||320},set:function(t){this.setAttribute("svg-height",t)}},{key:"svg-height",set:function(t){this.setAttribute("svg-height",t)}},{key:"legend",get:function(){var t=this.getAttribute("legend");return""===t||"true"===t},set:function(t){this.setAttribute("legend",t)}},{key:"labels",get:function(){var t=this.getAttribute("labels");return""===t||"true"===t},set:function(t){this.setAttribute("labels",t)}},{key:"branding",get:function(){return"false"!==this.getAttribute("branding")},set:function(t){this.setAttribute("branding",t)}},{key:"sortByScore",get:function(){var t=this.getAttribute("sort-by-score");return""===t||"true"===t},set:function(t){this.setAttribute("sort-by-score",t)}},{key:"sort-by-score",set:function(t){this.setAttribute("sort-by-score",t)}}],[{key:"observedAttributes",get:function(){return["username","id","max-labels","svg-width","svg-height","legend","labels","skills","active-skills","show-other-skills","sort-by-score"]}}]),e}(_wrapNativeSuper(HTMLElement));module.exports=CodersRankSkillsChart;
//# sourceMappingURL=/sm/fc73135543f7a0ed1ca148efb225eec845480af13b1e0f1905b1e6a2512bdfe8.map